(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{221:function(e,t,n){e.exports=n(506)},226:function(e,t,n){},248:function(e,t){},250:function(e,t){},271:function(e,t){},279:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=279},286:function(e,t){},287:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=287},324:function(e,t){},325:function(e,t){},410:function(e,t){},506:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(35),r=n.n(c),s=(n(226),n(17)),l="v1:us1:92b5460a-4e86-43cf-8c76-89d7244eddb1",i="d53611a7-c21a-4b5e-9283-1af5193cc23c:hstf+QJivn9tn+Y75+4/elSVeqzCRm2BUSYYX9PTuEI=",u=n(509),m=n(510),d=n(219),f=n(511),b=function(e){var t=Object(a.useState)(!0),n=Object(s.a)(t,2),c=n[0],r=n[1],l=Object(a.useState)(!1),i=Object(s.a)(l,2),b=i[0],h=i[1],p=function(){return r(!1)},E=Object(a.useState)("Choose..."),g=Object(s.a)(E,2),O=g[0],v=g[1],j=Object(a.useState)(""),S=Object(s.a)(j,2),C=S[0],N=S[1],w=Object(a.useState)(""),k=Object(s.a)(w,2),y=k[0],I=k[1];return o.a.createElement(u.a,{show:c,onHide:p,size:"sm",centered:!0,backdrop:"static"},o.a.createElement(u.a.Header,null,o.a.createElement(u.a.Title,null,b?"New User":"Authentication")),o.a.createElement(u.a.Body,null,b?o.a.createElement(m.a.Group,{as:d.a,controlId:"formGridState"},o.a.createElement(m.a.Label,null,"LOGIN ID"),o.a.createElement(m.a.Control,{type:"text",placeholder:"enter id",value:C,onChange:function(e){N(e.target.value)}}),o.a.createElement("br",null),o.a.createElement(m.a.Label,null,"DISPLAY NAME"),o.a.createElement(m.a.Control,{type:"text",placeholder:"enter name",value:y,onChange:function(e){I(e.target.value)}})):o.a.createElement(m.a.Group,{as:d.a,controlId:"formGridState"},o.a.createElement(m.a.Label,null,"Login as"),o.a.createElement(m.a.Control,{as:"select",onChange:function(e){v(e.target.value)}},o.a.createElement("option",null,"Choose..."),e.allUser.map((function(e,t){return o.a.createElement("option",{value:e,key:t},e)}))))),o.a.createElement(u.a.Footer,null,o.a.createElement(f.a,{variant:"Success",onClick:function(){b?(e.createNewUser(C,y),p()):(e.handleLogin(O),p())},disabled:b?0===y.length||0===C.length:"Choose..."===O},b?"Confirm":"Login"),o.a.createElement(f.a,{variant:"Warning",onClick:function(){h(!0)},disabled:"Choose..."!==O||b},"Create New User")))},h=n(59),p=n(127);var E=function(e){return o.a.createElement("div",{className:"message"},o.a.createElement("div",{className:"message-username"},e.userName),o.a.createElement("div",{className:"message-text"},e.text))};var g=function(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),c=n[0],r=n[1],l=Object(a.useRef)(),i=e.messages;return Object(a.useEffect)((function(){var e=l.current;r(e.scrollTop+e.clientHeight+200>=e.scrollHeight)})),Object(a.useLayoutEffect)((function(){var e=l.current;c&&(e.scrollTop=e.scrollHeight)}),[i,c]),e.currentRoomId?o.a.createElement("div",{ref:l,className:"message-list"},i.map((function(e,t){return o.a.createElement(E,{key:t,userName:e.sender.name,text:e.parts[0].payload.content})}))):o.a.createElement("div",{ref:l,className:"message-list"},o.a.createElement("div",{className:"join-room"},"\u2190 Join a room!"))},O=n(90),v=n(91),j=n(94),S=n(92),C=n(75),N=n(93),w=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(j.a)(this,Object(S.a)(t).call(this))).handleChange=function(t){e.setState({message:t.target.value})},e.handleSubmit=function(t){t.preventDefault(),e.props.sendSimpleMessage(e.state.message),e.setState({message:""})},e.state={message:""},e.handleChange=e.handleChange.bind(Object(C.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(C.a)(e)),e}return Object(N.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return o.a.createElement("form",{className:"send-message-form",onSubmit:this.handleSubmit},o.a.createElement("input",{disabled:this.props.disabled,onChange:this.handleChange,placeholder:"Type message and press ENTER to send",type:"text",value:this.state.message}))}}]),t}(o.a.Component),k=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(N.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this,t=Object(h.a)(this.props.rooms).sort((function(e,t){return e.name>t.name}));return o.a.createElement("div",{className:"rooms-list"},o.a.createElement("ul",null,o.a.createElement("h3",{style:{color:"#191970",fontWeight:100}},"MY ROOMS:"),t.map((function(t){var n=t.id===e.props.currentRoomId?"active":" ";return o.a.createElement("li",{key:t.id,className:"room "+n},o.a.createElement("a",{href:"#",onClick:function(){return e.props.subscribeToRoom(t.id)}},"# ",t.name))}))))}}]),t}(o.a.Component);var y=function(e){var t=Object(a.useState)(""),n=Object(s.a)(t,2),c=n[0],r=n[1];return o.a.createElement("div",{onSubmit:function(t){t.preventDefault(),e.createNewRoom(c),r("")},className:"new-room-form"},o.a.createElement("form",null,o.a.createElement("input",{onChange:function(e){r(e.target.value)},type:"text",placeholder:"Enter new room name",required:!0,value:c}),o.a.createElement("button",{id:"create-room-btn",type:"submit"},"+")))},I=function(e){var t=Object(a.useState)(null),n=Object(s.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)([]),u=Object(s.a)(i,2),m=u[0],d=u[1],f=Object(a.useState)(),b=Object(s.a)(f,2),E=b[0],O=b[1],v=Object(a.useState)([]),j=Object(s.a)(v,2),S=j[0],C=j[1],N=Object(a.useState)([]),I=Object(s.a)(N,2),R=I[0],L=I[1],U=function(e){d([]),E.subscribeToRoomMultipart({roomId:e,hooks:{onMessage:function(e){d((function(t){return[].concat(Object(h.a)(t),[e])}))}}}).then((function(e){T(),r(e.id)})).catch((function(e){console.log("Error on subscribing to room",e)}))},T=Object(a.useCallback)((function(){E&&E.getJoinableRooms().then((function(e){C(e),L(E.rooms)})).catch((function(e){console.log("Error on getting joinable rooms",e)}))}),[E]);return Object(a.useEffect)((function(){new p.ChatManager({instanceLocator:l,userId:e.selectId,tokenProvider:new p.TokenProvider({url:"https://us1.pusherplatform.io/services/chatkit_token_provider/v1/92b5460a-4e86-43cf-8c76-89d7244eddb1/token"})}).connect().then((function(e){O(e),T()})).catch((function(e){console.log("Error on connection",e)}))}),[T]),o.a.createElement("div",{className:"app"},o.a.createElement(k,{currentRoomId:c,rooms:[].concat(Object(h.a)(S),Object(h.a)(R)),subscribeToRoom:U}),o.a.createElement(g,{currentRoomId:c,messages:m}),o.a.createElement(w,{disabled:null===c,sendSimpleMessage:function(e){E.sendSimpleMessage({text:e,roomId:c})}}),o.a.createElement(y,{createNewRoom:function(e){E.createRoom({name:e}).then((function(e){U(e.id)})).catch((function(e){console.log("Error on create new room",e)}))}}))};var R=function(){var e=new(n(234).default)({instanceLocator:l,key:i}),t=Object(a.useState)([]),c=Object(s.a)(t,2),r=c[0],u=c[1],m=Object(a.useState)("ShiangHu"),d=Object(s.a)(m,2),f=d[0],h=d[1];Object(a.useEffect)((function(){e.getUsers().then((function(e){u(e.map((function(e){return e.id})))})).catch((function(e){console.log(e)}))}),[]);var p=function(e){h(e)};return o.a.createElement("div",null,o.a.createElement(b,{allUser:r,handleLogin:p,createNewUser:function(t,n){e.createUser({id:t,name:n}).then((function(){console.log("User created successfully")})).catch((function(e){console.log(e)})),p(t)}}),o.a.createElement(I,{selectId:f}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[221,1,2]]]);
//# sourceMappingURL=main.fcd1d54c.chunk.js.map